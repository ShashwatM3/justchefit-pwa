# JustChefIt PWA

A fully functional Progressive Web App (PWA) with Web Share Target API support, built with Next.js 16.

## Features

- ✅ **PWA Installation**: Installable on Android, iOS, and desktop devices
- ✅ **Web Share Target API**: Receive shared content (URLs, text, titles) from other apps
- ✅ **Offline Support**: Works offline with NetworkFirst caching strategy
- ✅ **Service Worker**: Automatic service worker generation with Workbox
- ✅ **Production Ready**: Optimized for production deployment

## Requirements

- **HTTPS**: PWAs require HTTPS in production. Use HTTPS for testing on mobile devices.
- **Node.js**: Version 18 or higher
- **Modern Browser**: Chrome, Edge, Firefox, Safari (latest versions)

## Installation

1. **Clone the repository** (or navigate to the project directory)

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Generate icons** (if not already generated):
   ```bash
   npm run generate-icons
   ```

## Development

### Run Development Server

```bash
npm run dev
```

Open [http://localhost:3000](http://localhost:3000) in your browser.

**Note**: PWA features are **disabled in development mode** by default. The service worker and PWA features only work in production builds.

### Build for Production

```bash
npm run build
```

### Start Production Server

```bash
npm start
```

## PWA Configuration

### Manifest.json

The app manifest is located at `public/manifest.json` and includes:
- App name, short name, and description
- Icons in various sizes (72x72 to 512x512)
- Maskable icon for Android adaptive icons
- Share target configuration for Web Share Target API
- Theme color and background color

### Service Worker

The service worker is automatically generated by `@ducanh2912/next-pwa` using Workbox. It includes:
- **NetworkFirst** caching strategy for all resources
- Static resource caching (images, fonts) with 30-day expiration
- Network-first caching with 10-second timeout
- Automatic registration and updates

### Icons

Icons are generated using the `generate-icons` script:
- Regular icons: 72x72, 96x96, 128x128, 144x144, 152x152, 192x192, 384x384, 512x512
- Maskable icon: 512x512 (with safe zone padding)

**To replace with custom icons**:
1. Create your icons in the required sizes
2. Place them in `public/icons/` directory
3. Ensure they follow the naming convention: `icon-{size}x{size}.png`
4. For maskable icon: `maskable-icon-512x512.png`

## Web Share Target API

The app implements the Web Share Target API to receive shared content from other apps.

### How It Works

1. User shares content (URL, text, etc.) from another app (e.g., Instagram, browser)
2. The app appears in the share menu as "JustChefIt"
3. User selects the app
4. The shared content is sent to `/share` endpoint via POST
5. The app redirects to the home page with the shared data as query parameters
6. The home page displays the shared content and alerts the user

### Share Target Configuration

The share target accepts:
- `title`: Title of the shared content
- `text`: Text content
- `url`: URL being shared

All parameters are optional and can be sent individually or together.

## Testing the PWA

### Prerequisites for Testing

1. **HTTPS Required**: PWAs require HTTPS in production. For local testing:
   - Use a service like [ngrok](https://ngrok.com/) to create an HTTPS tunnel
   - Or deploy to a hosting service (Vercel, Netlify, etc.)
   - Or use localhost with Chrome (for development testing only)

2. **Build the app**:
   ```bash
   npm run build
   npm start
   ```

### Testing on Android

1. **Deploy to HTTPS** (or use ngrok for local testing)

2. **Open the app URL** in Chrome on your Android device

3. **Install the PWA**:
   - Chrome will show an "Add to Home Screen" prompt
   - Or tap the menu (three dots) → "Install app" or "Add to Home screen"

4. **Test Share Target**:
   - Open Instagram or any app that supports sharing
   - Share a reel or any content
   - Look for "JustChefIt" in the share menu
   - Select it
   - The app should open and display the shared content

5. **Test Offline Mode**:
   - Install the app
   - Turn on airplane mode or disable WiFi
   - Open the app
   - It should still work (cached resources)

### Testing on Desktop (Chrome/Edge)

1. **Build and start**:
   ```bash
   npm run build
   npm start
   ```

2. **Open in Chrome/Edge** (HTTPS required)

3. **Install the PWA**:
   - Look for the install icon in the address bar
   - Or go to menu → "Install JustChefIt"

4. **Test Share Target**:
   - Share a URL from another app or website
   - Select "JustChefIt" from the share menu
   - The app should open and display the shared content

### Testing Share Endpoint Directly

You can test the share endpoint using curl:

```bash
curl -X POST http://localhost:3000/share \
  -F "title=Test Title" \
  -F "text=Test Text Content" \
  -F "url=https://example.com"
```

Or test via GET request:

```bash
curl "http://localhost:3000/share?title=Test&text=Content&url=https://example.com"
```

## iOS Limitations

⚠️ **Important**: iOS (Safari) does **NOT** support the Web Share Target API.

### What Works on iOS:
- ✅ PWA installation (Add to Home Screen)
- ✅ Offline functionality
- ✅ Service worker caching
- ✅ App-like experience when installed

### What Doesn't Work on iOS:
- ❌ Web Share Target API (receiving shares from other apps)
- ❌ App appearing in native share menu

### Why iOS Doesn't Support It:
Apple has not implemented the Web Share Target API specification in Safari/iOS. This is a limitation of iOS, not this app.

### Workaround for iOS:
Users can manually copy URLs and paste them into the app, or use other sharing methods that don't rely on the Web Share Target API.

## Project Structure

```
justchefit-pwa/
├── app/
│   ├── components/
│   │   └── SharedContent.tsx    # Component to display shared content
│   ├── share/
│   │   └── route.ts             # Web Share Target API endpoint
│   ├── layout.tsx               # Root layout with PWA metadata
│   ├── page.tsx                 # Home page with shared content display
│   └── globals.css
├── public/
│   ├── icons/                   # PWA icons (generated)
│   └── manifest.json            # PWA manifest
├── scripts/
│   └── generate-icons.js        # Icon generation script
├── next.config.ts               # Next.js config with PWA setup
└── package.json
```

## Production Deployment

### Requirements for Production

1. **HTTPS**: Mandatory for PWA features
2. **Build the app**: `npm run build`
3. **Start server**: `npm start` (or use a process manager like PM2)

### Recommended Hosting Platforms

- **Vercel**: Automatic HTTPS, easy deployment
- **Netlify**: Automatic HTTPS, PWA support
- **Railway**: Simple deployment with HTTPS
- **Any VPS**: Configure Nginx/Caddy with HTTPS

### Environment Variables

No environment variables are required for basic functionality.

### Build Optimization

The PWA is automatically optimized during build:
- Service worker is generated
- Icons are cached
- Static assets are optimized
- Network-first caching is configured

## Troubleshooting

### PWA Not Installing

1. **Check HTTPS**: Ensure you're using HTTPS (not HTTP)
2. **Check manifest**: Verify `manifest.json` is accessible
3. **Check service worker**: Ensure service worker is registered (check DevTools → Application → Service Workers)
4. **Clear cache**: Clear browser cache and try again

### Share Target Not Appearing

1. **Install the app first**: The share target only appears after installation
2. **Check manifest**: Verify `share_target` configuration in `manifest.json`
3. **HTTPS required**: Share target requires HTTPS
4. **Browser support**: Only Chrome/Edge on Android and desktop support this feature

### Service Worker Not Working

1. **Check production mode**: Service worker only works in production builds
2. **Clear service workers**: Go to DevTools → Application → Service Workers → Unregister
3. **Check console**: Look for service worker errors in the console

### Icons Not Showing

1. **Regenerate icons**: Run `npm run generate-icons`
2. **Check file paths**: Ensure icons are in `public/icons/`
3. **Check manifest**: Verify icon paths in `manifest.json`

## Development Notes

- PWA features are **disabled in development** (`npm run dev`) to avoid service worker conflicts
- Always test PWA features in production builds (`npm run build && npm start`)
- Use HTTPS for testing on mobile devices (use ngrok or deploy to staging)

## Browser Support

| Feature | Chrome/Edge | Firefox | Safari (Desktop) | Safari (iOS) |
|---------|-------------|---------|------------------|--------------|
| PWA Installation | ✅ | ✅ | ✅ | ✅ |
| Offline Support | ✅ | ✅ | ✅ | ✅ |
| Web Share Target | ✅ | ❌ | ❌ | ❌ |

## License

This project is open source and available under the MIT License.

## Additional Resources

- [Web Share Target API Specification](https://w3c.github.io/web-share-target/)
- [PWA Documentation](https://web.dev/progressive-web-apps/)
- [Next.js PWA Plugin](https://github.com/ducanh2912/next-pwa)
- [Workbox Documentation](https://developers.google.com/web/tools/workbox)

## Support

For issues or questions:
1. Check the troubleshooting section above
2. Review browser console for errors
3. Verify HTTPS and production build requirements